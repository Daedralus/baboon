<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Disney Princess Day â€” Paris Reveal</title>
<style>
  :root{ --bg:#fff7f4; --card:#ffffffe6; --accent:#c83a3a }
  html,body{height:100%;}
  body { font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; padding:24px; display:flex; align-items:center; justify-content:center; background:var(--bg); color:#222 }
  .frame{ width:100%; max-width:480px; background:transparent; border-radius:12px; overflow:hidden; box-shadow:0 12px 30px rgba(20,10,8,0.08); display:flex; flex-direction:column; height:100vh; max-height:800px; }
  .map-wrap{ position:relative; background:transparent; flex-shrink:0; }
  .image-container{ position:relative; width:100%; height:auto; min-height:200px; background:#f8f8f8; border-radius:8px; overflow:hidden; }
  #map { display:block; width:100%; height:auto; border-radius:8px; transition: opacity 0.5s ease; position:relative; z-index:1; }
  .photo-indicator{ position:absolute; top:10px; right:10px; background:rgba(0,0,0,0.7); color:white; padding:4px 8px; border-radius:12px; font-size:0.8rem; z-index:2; }

  .content{ padding:18px; background:transparent; flex:1; overflow-y:auto; max-height:300px; }
  .card{ background:var(--card); border-radius:10px; padding:14px 16px; margin:12px 0; box-shadow:0 6px 18px rgba(30,15,10,0.06); opacity:0; transform:translateY(8px); transition:all 420ms ease; }
  .card.show{ opacity:1; transform:none; }
  .card.current{ border-left:3px solid var(--accent); }
  .card.previous{ opacity:0.6; background:rgba(255,255,255,0.4); }
  .stage-title{ font-weight:600; margin-bottom:6px; cursor:pointer; }
  .stage-title:hover{ color:var(--accent); }
  .small{ font-size:0.92rem; color:#444 }
  #intro .stage-title{ cursor:pointer; user-select:none; transition: all 300ms ease; }
  .controls{ display:flex; gap:8px; justify-content:center; padding:12px; }
  
  /* Modal popup */
  .modal{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; align-items:center; justify-content:center; }
  .modal.show{ display:flex; }
  .modal-content{ background:white; border-radius:16px; padding:24px; max-width:400px; width:90%; max-height:80vh; overflow-y:auto; box-shadow:0 20px 60px rgba(0,0,0,0.3); }
  .modal-header{ font-size:1.3rem; font-weight:700; margin-bottom:12px; color:var(--accent); }
  .modal-body{ font-size:0.95rem; line-height:1.6; margin-bottom:16px; }
  .modal-links{ margin-top:16px; }
  .modal-link{ display:block; padding:10px 16px; background:#f0f0f0; border-radius:8px; margin:8px 0; text-decoration:none; color:#333; font-weight:600; text-align:center; }
  .modal-link:hover{ background:#e0e0e0; }
  .modal-image{ width:100%; max-width:100%; border-radius:8px; margin:12px 0; cursor:pointer; transition:transform 0.2s; }
  .modal-image:hover{ transform:scale(1.02); }
  .modal-image-btn{ display:block; padding:10px 16px; background:var(--accent); color:white; border-radius:8px; margin:8px 0; text-align:center; font-weight:600; cursor:pointer; border:none; width:100%; }
  .modal-image-btn:hover{ opacity:0.9; }
  .modal-close{ background:var(--accent); color:white; border:none; padding:10px 20px; border-radius:8px; width:100%; font-weight:600; cursor:pointer; margin-top:12px; }
  
  /* Image popup overlay */
  .image-overlay{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:2000; align-items:center; justify-content:center; padding:20px; box-sizing:border-box; }
  .image-overlay.show{ display:flex; }
  .image-overlay img{ max-width:90%; max-height:90%; object-fit:contain; border-radius:8px; }
  .image-overlay-close{ position:absolute; top:20px; right:30px; color:white; font-size:40px; font-weight:bold; cursor:pointer; background:rgba(0,0,0,0.5); border-radius:50%; width:50px; height:50px; display:flex; align-items:center; justify-content:center; }
  
  button{ background:#fff; border:1px solid #eee; padding:10px 14px; border-radius:9px; font-weight:600; cursor:pointer }
  button.primary{ background:var(--accent); color:white; border:none }
  
  /* Mobile optimizations */
  @media (max-width: 480px) {
    body { padding: 8px; }
    .frame { 
      max-width: 100%; 
      height: 100vh; 
      max-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .map-wrap {
      flex-shrink: 0;
      height: auto;
      min-height: 200px;
      max-height: 280px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .image-container {
      width: 100%;
      height: 280px; /* Smaller fixed height */
      min-height: 280px;
      max-height: 280px;
      background: #f8f8f8;
      border: 1px solid #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    #map {
      width: auto;
      max-width: 100%;
      height: auto;
      max-height: 100%;
      object-fit: contain;
      border-radius: 4px;
    }
    
    /* Force consistent size for all path images */
    #map {
      max-height: 260px !important;
      width: auto !important;
      object-fit: contain !important;
    }
    
    .photo-indicator {
      font-size: 0.75rem;
      padding: 3px 6px;
      top: 8px;
      right: 8px;
    }
    
    .content {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      max-height: calc(100vh - 330px); /* Adjusted for smaller image container */
    }
    
    .controls {
      flex-direction: column;
      gap: 10px;
      padding: 12px;
      flex-shrink: 0;
    }
    
    button {
      width: 100%;
      padding: 12px 16px;
      font-size: 0.9rem;
    }
  }
  
  @media (max-width: 375px) {
    .frame { 
      margin: 0;
      height: 100vh;
    }
    
    .map-wrap {
      max-height: 280px;
    }
    
    .image-container {
      height: 280px;
      min-height: 280px;
      max-height: 280px;
    }
    
    #map {
      max-height: 100%; /* Use container height */
    }
    
    .content {
      max-height: calc(100vh - 350px);
    }
  }

</style>
</head>
<body>
  <div class="frame" role="main">
    <div class="map-wrap">
      <div class="image-container">
        <img id="map" src="photos/paris/cheeseF.jpg" alt="Paris travel path map">
        <div class="photo-indicator" id="photoIndicator">Path 1/8</div>
      </div>
    </div>

    <div class="content" id="contentArea">
      <div class="card show" id="intro">
        <div class="stage-title">Paris Tedventure</div>
        <div class="small">This page incorporates baguette magic to update in real time - I hope you enjoy today lots! I love you so much my disney princess babyboooonnn! (PS: Cute detail at end)</div>
      </div>
    </div>

<!--
    <div class="controls">
      <button id="manualBtn">Reveal Next</button>
      <button id="testBtn">Show All (test)</button>
    </div>
-->
  </div>

  <!-- Modal for stage details -->
  <div class="modal" id="stageModal">
    <div class="modal-content">
      <div class="modal-header" id="modalTitle"></div>
      <div class="modal-body" id="modalBody"></div>
      <div class="modal-links" id="modalLinks"></div>
      <button class="modal-close" onclick="closeModal()">Close</button>
    </div>
  </div>

  <!-- Image overlay popup -->
  <div class="image-overlay" id="imageOverlay" onclick="closeImageOverlay()">
    <span class="image-overlay-close">&times;</span>
    <img id="overlayImage" src="" alt="Ticket">
  </div>

<script>
// Stage data (Paris local times) - ISO with CET offset (+01:00)
const stages = [
  { 
    time: '2025-11-08T10:30:00+01:00', 
    title: 'Croissant Class', 
    note:'10:30 â€” 12:30', 
    photo: 'Path1.png',
    details: 'Learn to make authentic French croissants with a local pastry chef at a cozy bakery in Le Marais.',
    links: [
      { text: 'View Location on Maps', url: 'https://maps.google.com/?q=25+Rue+de+Bretagne+Paris' },
      { text: 'Class Information', url: 'https://www.getyourguide.com/en-au/paris-l16/paris-baking-insider-experience-t649804/?ranking_uuid=47883e7b-da39-46d1-9ce0-86e488ddcb4e' }
    ]
  },
  { 
    time: '2025-11-08T12:30:00+01:00', 
    title: 'MarchÃ© couvert des Enfants Rouges', 
    note:'12:30 â€” 13:05', 
    photo: 'Path2.png',
    details: 'Explore the oldest covered market in Paris, offering a variety of international food stalls and fresh produce.',
    links: [
      { text: 'View Location on Maps', url: 'https://www.google.com/maps/place/MarchÃ©+couvert+des+Enfants+Rouges/@48.8479961,2.3208634,14z/data=!4m6!3m5!1s0x47e66e0683f48c17:0x8cf0914d1194139b!8m2!3d48.8628656!4d2.3620448!16s%2Fg%2F11gjwg4t_g?entry=ttu&g_ep=EgoyMDI1MTEwMi4wIKXMDSoASAFQAw%3D%3D' },
      { text: 'Oldest Covered Market of Paris', url: 'https://www.parisinsidersguide.com/marche-des-enfants-rouges-paris.html' }
    ]
  },
  { 
    time: '2025-11-08T13:30:00+01:00', 
    title: 'MusÃ©e Vivant du Fromage â€” ÃŽle Saint-Louis', 
    note:'13:30 â€” 15:00', 
    photo: 'Path3.png',
    details: 'Discover the art of French cheese-making at this interactive cheese museum.',
    links: [
      { text: 'View Location on Maps', url: 'https://maps.app.goo.gl/rJvfh7opnda9oJmo6' },
      { text: 'Museum Website', url: 'https://musee-fromage-paris.com/en' }
    ],
    image: 'photos/paris/cheese.png'
  },
  { 
    time: '2025-11-08T15:00:00+01:00', 
    title: 'Notre Dame Stroll', 
    note:'15:00 â€” 15:45', 
    photo: 'Path4.png',
    details: 'Stroll around the historic Notre Dame cathedral and the surrounding area.',
    links: [
      { text: 'View Location on Maps', url: 'https://maps.app.goo.gl/kqaUUwQWjMwZgmiU9' },
      { text: 'Notre Dame Info', url: 'https://www.notredamedeparis.fr/en/' }
    ]
  },
  { 
    time: '2025-11-08T15:40:00+01:00', 
    title: 'To The Boat!', 
    note:'15:45-16:30', 
    photo: 'Path4.png',
    details: 'Walk to the Seine and board the Batobus for a scenic river cruise to the Eiffel Tower.',
    links: [
      { text: 'Batobus Information', url: 'https://www.batobus.com/en' },
      { text: 'Our Port', url: 'https://maps.app.goo.gl/pjntZLaPcqgvqRYy7' }
    ]
  },
  { 
    time: '2025-11-08T16:30:00+01:00', 
    title: 'Eiffel Arrival â€” Golden Hour + Shopping', 
    note:'16:30-19:00', 
    photo: 'Path5.png',
    details: 'Arrive at the Eiffel Tower during golden hour for stunning photos and explore nearby shops.',
    links: [
      { text: 'Eiffel Tower Info', url: 'https://www.toureiffel.paris/en' },
      { text: 'Shopping Area', url: 'https://maps.app.goo.gl/khRS43aNQXkwcD33A' }
    ]
  },
  { 
    time: '2025-11-08T19:00:00+01:00', 
    title: 'Dinner at Le Petit Cler', 
    note:'19:00-21:00', 
    photo: 'Path6.png',
    details: 'Enjoy a traditional French dinner at this charming bistro near the Eiffel Tower.',
    links: [
      { text: 'View Location on Maps', url: 'https://maps.app.goo.gl/itbjJQdGrtCvNiVr9' },
      { text: 'Restaurant Website', url: 'https://menuonline.fr/en/lepetitcler' }
    ]
  },
  { 
    time: '2025-11-08T21:00:00+01:00', 
    title: 'End of Day', 
    note:'21:00-00:00', 
    photo: 'Path7.png',
    details: 'Return to the hotel and relax after amazing Paris Tedventure-Date.',
    links: [
      { text: 'Initiate Sexy Time', url: 'https://maps.app.goo.gl/YHYFRqSgAnMYj6km6' }
    ]
  }
];

let revealed = -1;
const content = document.getElementById('contentArea');
const manualBtn = document.getElementById('manualBtn');
const testBtn = document.getElementById('testBtn');
const mapImg = document.getElementById('map');
const photoIndicator = document.getElementById('photoIndicator');

// Initialize with first photo
mapImg.src = 'photos/paris/cheeseF.jpg';
mapImg.alt = 'Croissant class - Travel path map';
photoIndicator.textContent = 'Path 1/8';

// Helper: get current Paris time as a Date object
function nowInParis(){
  try{
    const fmt = new Intl.DateTimeFormat('en-GB', { timeZone: 'Europe/Paris', year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false });
    const parts = fmt.formatToParts(new Date());
    const map = {};
    parts.forEach(p=> map[p.type]=p.value);
    const iso = `${map.year}-${map.month}-${map.day}T${map.hour}:${map.minute}:${map.second}+01:00`;
    return new Date(iso);
  }catch(e){
    // fallback to local time (best-effort)
    return new Date();
  }
}

function createCard(stageIndex){
  const s = stages[stageIndex];
  const card = document.createElement('div');
  card.className='card show current';
  const title = document.createElement('div'); 
  title.className='stage-title'; 
  title.textContent = s.title;
  title.onclick = () => openModal(stageIndex);
  const note = document.createElement('div'); 
  note.className='small'; 
  note.textContent = s.note;
  card.appendChild(title); 
  card.appendChild(note);
  
  // Gray out all existing stage cards
  document.querySelectorAll('.card.current').forEach(c => {
    c.classList.remove('current');
    c.classList.add('previous');
  });
  
  // Insert at second position (after intro)
  if (content.children.length > 1) {
    content.insertBefore(card, content.children[1]);
  } else {
    content.appendChild(card);
  }
  
  // Update map photo to current stage
  updateMapPhoto(stageIndex);
}

function openModal(stageIndex) {
  const s = stages[stageIndex];
  document.getElementById('modalTitle').textContent = s.title;
  document.getElementById('modalBody').textContent = s.details || s.note;
  
  const linksContainer = document.getElementById('modalLinks');
  linksContainer.innerHTML = '';
  
  // Add image button if exists
  if (s.image) {
    const btn = document.createElement('button');
    btn.className = 'modal-image-btn';
    btn.textContent = 'ðŸŽ« View Tickets';
    btn.onclick = () => openImageOverlay(s.image);
    linksContainer.appendChild(btn);
  }
  
  // Add links if exists
  if (s.links && s.links.length > 0) {
    s.links.forEach(link => {
      const a = document.createElement('a');
      a.className = 'modal-link';
      a.href = link.url;
      a.textContent = link.text;
      a.target = '_blank';
      linksContainer.appendChild(a);
    });
  }
  
  document.getElementById('stageModal').classList.add('show');
}

function closeModal() {
  document.getElementById('stageModal').classList.remove('show');
}

function openImageOverlay(imageSrc) {
  document.getElementById('overlayImage').src = imageSrc;
  document.getElementById('imageOverlay').classList.add('show');
}

function closeImageOverlay() {
  document.getElementById('imageOverlay').classList.remove('show');
}

function updateMapPhoto(stageIndex) {
  const s = stages[stageIndex];
  if (s.photo) {
    mapImg.style.opacity = '0.5';
    setTimeout(() => {
      mapImg.src = `photos/paris/${s.photo}`;
      mapImg.alt = `${s.title} - Travel path map`;
      photoIndicator.textContent = `Path ${stageIndex + 1}/8`;
      
      // Force maintain proper styling after image swap
      mapImg.style.width = 'auto';
      mapImg.style.maxWidth = '100%';
      mapImg.style.height = 'auto';
      mapImg.style.maxHeight = '100%';
      mapImg.style.objectFit = 'contain';
      mapImg.style.display = 'block';
      mapImg.style.opacity = '1';
      
      // Ensure the map stays visible (scroll to top of page if needed)
      if (window.scrollY > 100) {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }, 250);
  }
}

function checkAuto(){
  const now = nowInParis();
  for(let i=0;i<stages.length;i++){
    const t = new Date(stages[i].time);
    if(now >= t && i > revealed){
      revealed = i;
      createCard(i);
    }
  }
}

// Hold title for 5 seconds to reveal next
let holdTimer = null;
const titleEl = document.querySelector('#intro .stage-title');

titleEl.addEventListener('touchstart', startHold);
titleEl.addEventListener('mousedown', startHold);
titleEl.addEventListener('touchend', cancelHold);
titleEl.addEventListener('mouseup', cancelHold);
titleEl.addEventListener('touchcancel', cancelHold);
titleEl.addEventListener('mouseleave', cancelHold);

function startHold(e) {
  e.preventDefault();
  titleEl.style.opacity = '0.6';
  titleEl.style.transform = 'scale(0.95)';
  holdTimer = setTimeout(() => {
    const next = Math.min(revealed+1, stages.length-1);
    if(next > revealed){ 
      revealed = next; 
      createCard(next); 
    }
    titleEl.style.opacity = '1';
    titleEl.style.transform = 'scale(1)';
  }, 3000);
}

function cancelHold() {
  titleEl.style.opacity = '1';
  titleEl.style.transform = 'scale(1)';
  if (holdTimer) {
    clearTimeout(holdTimer);
    holdTimer = null;
  }
}

// Manual button interactions
if (manualBtn) {
  manualBtn.addEventListener('click', () => {
    const next = Math.min(revealed+1, stages.length-1);
    if(next > revealed){ revealed = next; createCard(next); }
  });
}

if (testBtn) {
  testBtn.addEventListener('click', () => {
    for(let i=0; i<stages.length; i++){
      if(i>revealed){ revealed=i; createCard(i); }
    }
  });
}

// initial run: show intro then run auto-check every 10s
checkAuto();
setInterval(checkAuto, 10000);
</script>
</body>
</html>
